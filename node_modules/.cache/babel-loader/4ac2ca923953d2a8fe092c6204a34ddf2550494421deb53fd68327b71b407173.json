{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\hp\\\\OneDrive\\\\Desktop\\\\frontend\\\\src\\\\components\\\\ChatbotApp.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Shell, Sparkles, X } from 'lucide-react';\nimport RandomColorLoader from './looader/RandomColorLoader';\nimport BASE_URL from '../config';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ChatBotApp({\n  onClose\n}) {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [inputText, setInputText] = useState('');\n  const [selectedImage, setSelectedImage] = useState(null);\n  const [imagePreviewUrl, setImagePreviewUrl] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSummarizing, setIsSummarizing] = useState(false);\n  const [error, setError] = useState(null);\n  const messagesEndRef = useRef(null);\n  const textareaRef = useRef(null);\n  const backendUrl = `http://${BASE_URL}/admin/api/chat`;\n  const token = localStorage.getItem(\"lalitkumar_choudhary\");\n  useEffect(() => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  }, [messages]);\n  useEffect(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\n    }\n  }, [inputText]);\n  const handleInputChange = e => {\n    setInputText(e.target.value);\n  };\n  const handleImageChange = e => {\n    const file = e.target.files[0];\n    if (file) {\n      setSelectedImage(file);\n      setImagePreviewUrl(URL.createObjectURL(file));\n    }\n  };\n  const handleRemoveImage = () => {\n    setSelectedImage(null);\n    setImagePreviewUrl(null);\n    if (document.getElementById('imageUpload')) {\n      document.getElementById('imageUpload').value = '';\n    }\n  };\n  const fileToBase64 = file => {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onloadend = () => resolve(reader.result.split(',')[1]);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  };\n\n  // New function to send requests to the backend\n  const sendToBackend = async payload => {\n    try {\n      const response = await fetch(backendUrl, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(payload)\n      });\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.error || `HTTP error! status: ${response.status}`);\n      }\n      return await response.json();\n    } catch (error) {\n      console.error('Error sending request to backend:', error);\n      throw error;\n    }\n  };\n  const handleSendMessage = async () => {\n    if (!inputText.trim() && !selectedImage) {\n      return;\n    }\n    setIsLoading(true);\n    setError(null);\n    const userMessage = {\n      type: 'user',\n      text: inputText.trim(),\n      image: imagePreviewUrl\n    };\n    setMessages(prevMessages => [...prevMessages, userMessage]);\n    try {\n      const chatHistory = [{\n        role: 'user',\n        parts: [{\n          text: inputText.trim()\n        }]\n      }];\n      const payload = {\n        messages: chatHistory\n      };\n      if (selectedImage) {\n        const base64ImageData = await fileToBase64(selectedImage);\n        payload.image = base64ImageData;\n        payload.mimeType = selectedImage.type;\n      }\n      const result = await sendToBackend(payload);\n      if (result !== null && result !== void 0 && result.text) {\n        setMessages(prevMessages => [...prevMessages, {\n          type: 'bot',\n          text: result.text\n        }]);\n      } else {\n        throw new Error('Invalid API response structure from backend.');\n      }\n    } catch (err) {\n      console.error('Error sending message:', err);\n      setError('Failed to get response from chatbot. Please try again.');\n      setMessages(prevMessages => [...prevMessages, {\n        type: 'bot',\n        text: 'Oops! Something went wrong. Please try again.'\n      }]);\n    } finally {\n      setIsLoading(false);\n      setInputText('');\n      handleRemoveImage();\n    }\n  };\n  const handleSummarizeChat = async () => {\n    if (messages.length === 0) {\n      setError('No conversation to summarize.');\n      return;\n    }\n    setIsSummarizing(true);\n    setError(null);\n    try {\n      const conversationText = messages.map(msg => {\n        if (msg.type === 'user') {\n          return `User: ${msg.text}`;\n        } else {\n          return `Bot: ${msg.text}`;\n        }\n      }).join('\\n');\n      const prompt = `Please provide a concise summary of the following conversation:\\n\\n${conversationText}`;\n      const payload = {\n        messages: [{\n          role: 'user',\n          parts: [{\n            text: prompt\n          }]\n        }]\n      };\n      const result = await sendToBackend(payload);\n      if (result !== null && result !== void 0 && result.text) {\n        const summaryText = result.text;\n        setMessages(prevMessages => [...prevMessages, {\n          type: 'bot',\n          text: `✨ Chat Summary:\\n${summaryText}`\n        }]);\n      } else {\n        throw new Error('Invalid API response structure for summarization.');\n      }\n    } catch (err) {\n      console.error('Error summarizing chat:', err);\n      setError('Failed to summarize chat. Please try again.');\n    } finally {\n      setIsSummarizing(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col h-full font-sans bg-[#2a2a2a] text-[#f0f0f0] rounded-lg shadow-2xl\",\n    children: [/*#__PURE__*/_jsxDEV(\"header\", {\n      className: \"flex items-center justify-between p-4 bg-gradient-to-r from-[#2c4e4e] to-[#4e7d7d] text-white shadow-lg rounded-t-xl\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center\",\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-xl font-bold tracking-wide flex items-center\",\n          children: [\"Hello, it's \", /*#__PURE__*/_jsxDEV(Shell, {\n            className: \"mx-2 text-[#b0e0e6]\",\n            size: 28\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-2 ml-auto\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSummarizeChat,\n          className: `p-2 rounded-md transition-colors ${isSummarizing ? 'bg-[#1a2d2d] text-[#a0a0a0] cursor-not-allowed' : 'text-white bg-[#5f9ea0] hover:bg-[#4d8c8e]'}`,\n          disabled: isSummarizing,\n          \"aria-label\": \"Summarize chat\",\n          children: isSummarizing ? /*#__PURE__*/_jsxDEV(RandomColorLoader, {\n            className: \"h-6 w-6\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(Sparkles, {\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 11\n        }, this), onClose && /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: onClose,\n          className: \"p-2 rounded-md text-gray-200 hover:text-white hover:bg-[#2c4e4e]\",\n          \"aria-label\": \"Close chat\",\n          children: /*#__PURE__*/_jsxDEV(X, {\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar\",\n      children: [messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex items-start ${msg.type === 'user' ? 'justify-end' : 'justify-start'}`,\n        children: [msg.type === 'bot' && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-shrink-0 mr-3 mt-1\",\n          children: /*#__PURE__*/_jsxDEV(Shell, {\n            className: \"text-[#a0e0e6]\",\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `max-w-[70%] p-3 rounded-xl shadow-md sm:max-w-[60%] ${msg.type === 'user' ? 'bg-[#3d7c7c] text-white rounded-br-none' : 'bg-[#2c4e4e] text-gray-200 rounded-bl-none'}`,\n          children: [msg.image && /*#__PURE__*/_jsxDEV(\"img\", {\n            src: msg.image,\n            alt: \"Uploaded preview\",\n            className: \"max-h-24 w-auto rounded-md mb-2 border border-[#4e7d7d]\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"whitespace-pre-wrap\",\n            children: msg.text\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 13\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 11\n      }, this)), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-start items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-shrink-0 mr-3 mt-1\",\n          children: /*#__PURE__*/_jsxDEV(Shell, {\n            className: \"text-[#a0e0e6] animate-pulse\",\n            size: 24\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-[#2c4e4e] p-3 rounded-xl shadow-md rounded-bl-none\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex space-x-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-2 h-2 bg-[#5f9ea0] rounded-full animate-bounce\",\n              style: {\n                animationDelay: '0s'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-2 h-2 bg-[#5f9ea0] rounded-full animate-bounce\",\n              style: {\n                animationDelay: '0.2s'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"w-2 h-2 bg-[#5f9ea0] rounded-full animate-bounce\",\n              style: {\n                animationDelay: '0.4s'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-[#e6b0b0] text-center p-2 bg-[#5c2d2d] rounded-lg\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-4 bg-[#2c4e4e] border-t border-[#4e7d7d] shadow-inner rounded-b-xl\",\n      children: [imagePreviewUrl && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative mb-3 p-2 border border-[#4e7d7d] rounded-lg bg-[#3d7c7c]\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: imagePreviewUrl,\n          alt: \"Image Preview\",\n          className: \"max-h-24 w-auto rounded-md mx-auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleRemoveImage,\n          className: \"absolute top-1 right-1 bg-[#d32f2f] text-white rounded-full p-1 text-xs hover:bg-[#e53935] transition-colors\",\n          \"aria-label\": \"Remove image\",\n          children: /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"h-4 w-4\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            stroke: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M6 18L18 6M6 6l12 12\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-end space-x-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"imageUpload\",\n          className: \"flex-shrink-0 p-3 bg-[#3d7c7c] text-[#a0e0e6] rounded-full cursor-pointer hover:bg-[#4e8d8e] transition-colors shadow-sm\",\n          title: \"Upload Image\",\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"h-6 w-6\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            stroke: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"imageUpload\",\n            type: \"file\",\n            accept: \"image/*\",\n            className: \"hidden\",\n            onChange: handleImageChange,\n            disabled: isLoading || isSummarizing\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: textareaRef,\n          className: \"flex-1 resize-none overflow-hidden p-3 border border-[#4e7d7d] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#a0e0e6] text-gray-100 bg-[#3d7c7c] transition-all duration-200 text-sm sm:text-base\",\n          placeholder: \"Type your message...\",\n          rows: \"1\",\n          value: inputText,\n          onChange: handleInputChange,\n          onKeyPress: e => {\n            if (e.key === 'Enter' && !e.shiftKey) {\n              e.preventDefault();\n              handleSendMessage();\n            }\n          },\n          disabled: isLoading || isSummarizing\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleSendMessage,\n          className: `flex-shrink-0 p-3 rounded-full shadow-lg transition-all duration-200 ${isLoading || isSummarizing || !inputText.trim() && !selectedImage ? 'bg-[#3d7c7c] text-[#a0a0a0] cursor-not-allowed' : 'bg-[#5f9ea0] text-white hover:bg-[#4d8c8e]'}`,\n          disabled: isLoading || isSummarizing || !inputText.trim() && !selectedImage,\n          title: \"Send Message\",\n          children: isLoading ? /*#__PURE__*/_jsxDEV(\"svg\", {\n            className: \"animate-spin h-6 w-6 text-white\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            children: [/*#__PURE__*/_jsxDEV(\"circle\", {\n              className: \"opacity-25\",\n              cx: \"12\",\n              cy: \"12\",\n              r: \"10\",\n              stroke: \"currentColor\",\n              strokeWidth: \"4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n              className: \"opacity-75\",\n              fill: \"currentColor\",\n              d: \"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 369,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"svg\", {\n            xmlns: \"http://www.w3.org/2000/svg\",\n            className: \"h-6 w-6 rotate-90\",\n            fill: \"none\",\n            viewBox: \"0 0 24 24\",\n            stroke: \"currentColor\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              strokeLinecap: \"round\",\n              strokeLinejoin: \"round\",\n              strokeWidth: 2,\n              d: \"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 383,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 376,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 344,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"style\", {\n      children: `\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 8px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: #3d7c7c;\n          border-radius: 10px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: #5f9ea0;\n          border-radius: 10px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #a0e0e6;\n        }\n      `\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 182,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatBotApp, \"41jTBMsizv4u45nX3MJW6qbrbfY=\");\n_c = ChatBotApp;\nexport default ChatBotApp;\nvar _c;\n$RefreshReg$(_c, \"ChatBotApp\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Shell","Sparkles","X","RandomColorLoader","BASE_URL","jsxDEV","_jsxDEV","ChatBotApp","onClose","_s","messages","setMessages","inputText","setInputText","selectedImage","setSelectedImage","imagePreviewUrl","setImagePreviewUrl","isLoading","setIsLoading","isSummarizing","setIsSummarizing","error","setError","messagesEndRef","textareaRef","backendUrl","token","localStorage","getItem","_messagesEndRef$curre","current","scrollIntoView","behavior","style","height","scrollHeight","handleInputChange","e","target","value","handleImageChange","file","files","URL","createObjectURL","handleRemoveImage","document","getElementById","fileToBase64","Promise","resolve","reject","reader","FileReader","onloadend","result","split","onerror","readAsDataURL","sendToBackend","payload","response","fetch","method","headers","body","JSON","stringify","ok","errorData","json","Error","status","console","handleSendMessage","trim","userMessage","type","text","image","prevMessages","chatHistory","role","parts","base64ImageData","mimeType","err","handleSummarizeChat","length","conversationText","map","msg","join","prompt","summaryText","className","children","size","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","index","src","alt","animationDelay","ref","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","htmlFor","title","id","accept","onChange","placeholder","rows","onKeyPress","key","shiftKey","preventDefault","cx","cy","r","_c","$RefreshReg$"],"sources":["C:/Users/hp/OneDrive/Desktop/frontend/src/components/ChatbotApp.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Shell, Sparkles, X } from 'lucide-react';\r\nimport RandomColorLoader from './looader/RandomColorLoader';\r\nimport BASE_URL from '../config';\r\n\r\nfunction ChatBotApp({ onClose }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [inputText, setInputText] = useState('');\r\n  const [selectedImage, setSelectedImage] = useState(null);\r\n  const [imagePreviewUrl, setImagePreviewUrl] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [isSummarizing, setIsSummarizing] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  const messagesEndRef = useRef(null);\r\n  const textareaRef = useRef(null);\r\n  const backendUrl = `http://${BASE_URL}/admin/api/chat`;\r\n  const token = localStorage.getItem(\"lalitkumar_choudhary\");\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  useEffect(() => {\r\n    if (textareaRef.current) {\r\n      textareaRef.current.style.height = 'auto';\r\n      textareaRef.current.style.height = textareaRef.current.scrollHeight + 'px';\r\n    }\r\n  }, [inputText]);\r\n\r\n  const handleInputChange = (e) => {\r\n    setInputText(e.target.value);\r\n  };\r\n\r\n  const handleImageChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (file) {\r\n      setSelectedImage(file);\r\n      setImagePreviewUrl(URL.createObjectURL(file));\r\n    }\r\n  };\r\n\r\n  const handleRemoveImage = () => {\r\n    setSelectedImage(null);\r\n    setImagePreviewUrl(null);\r\n    if (document.getElementById('imageUpload')) {\r\n      document.getElementById('imageUpload').value = '';\r\n    }\r\n  };\r\n\r\n  const fileToBase64 = (file) => {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => resolve(reader.result.split(',')[1]);\r\n      reader.onerror = reject;\r\n      reader.readAsDataURL(file);\r\n    });\r\n  };\r\n\r\n  // New function to send requests to the backend\r\n  const sendToBackend = async (payload) => {\r\n    try {\r\n      const response = await fetch(backendUrl, {\r\n        method: 'POST',\r\n        headers: {     \r\n            'Authorization': `Bearer ${token}`,\r\n          'Content-Type': 'application/json'\r\n         },\r\n        body: JSON.stringify(payload),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || `HTTP error! status: ${response.status}`);\r\n      }\r\n\r\n      return await response.json();\r\n    } catch (error) {\r\n      console.error('Error sending request to backend:', error);\r\n      throw error;\r\n    }\r\n  };\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!inputText.trim() && !selectedImage) {\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    setError(null);\r\n\r\n    const userMessage = {\r\n      type: 'user',\r\n      text: inputText.trim(),\r\n      image: imagePreviewUrl,\r\n    };\r\n    setMessages((prevMessages) => [...prevMessages, userMessage]);\r\n\r\n    try {\r\n      const chatHistory = [{\r\n        role: 'user',\r\n        parts: [{ text: inputText.trim() }],\r\n      }];\r\n\r\n      const payload = {\r\n        messages: chatHistory,\r\n      };\r\n\r\n      if (selectedImage) {\r\n        const base64ImageData = await fileToBase64(selectedImage);\r\n        payload.image = base64ImageData;\r\n        payload.mimeType = selectedImage.type;\r\n      }\r\n\r\n      const result = await sendToBackend(payload);\r\n      \r\n      if (result?.text) {\r\n        setMessages((prevMessages) => [\r\n          ...prevMessages,\r\n          { type: 'bot', text: result.text },\r\n        ]);\r\n      } else {\r\n        throw new Error('Invalid API response structure from backend.');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error sending message:', err);\r\n      setError('Failed to get response from chatbot. Please try again.');\r\n      setMessages((prevMessages) => [\r\n        ...prevMessages,\r\n        { type: 'bot', text: 'Oops! Something went wrong. Please try again.' },\r\n      ]);\r\n    } finally {\r\n      setIsLoading(false);\r\n      setInputText('');\r\n      handleRemoveImage();\r\n    }\r\n  };\r\n\r\n  const handleSummarizeChat = async () => {\r\n    if (messages.length === 0) {\r\n      setError('No conversation to summarize.');\r\n      return;\r\n    }\r\n\r\n    setIsSummarizing(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const conversationText = messages.map(msg => {\r\n        if (msg.type === 'user') {\r\n          return `User: ${msg.text}`;\r\n        } else {\r\n          return `Bot: ${msg.text}`;\r\n        }\r\n      }).join('\\n');\r\n\r\n      const prompt = `Please provide a concise summary of the following conversation:\\n\\n${conversationText}`;\r\n      const payload = {\r\n        messages: [{ role: 'user', parts: [{ text: prompt }] }],\r\n      };\r\n\r\n      const result = await sendToBackend(payload);\r\n\r\n      if (result?.text) {\r\n        const summaryText = result.text;\r\n        setMessages((prevMessages) => [\r\n          ...prevMessages,\r\n          { type: 'bot', text: `✨ Chat Summary:\\n${summaryText}` },\r\n        ]);\r\n      } else {\r\n        throw new Error('Invalid API response structure for summarization.');\r\n      }\r\n    } catch (err) {\r\n      console.error('Error summarizing chat:', err);\r\n      setError('Failed to summarize chat. Please try again.');\r\n    } finally {\r\n      setIsSummarizing(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full font-sans bg-[#2a2a2a] text-[#f0f0f0] rounded-lg shadow-2xl\">\r\n      {/* Header */}\r\n      <header className=\"flex items-center justify-between p-4 bg-gradient-to-r from-[#2c4e4e] to-[#4e7d7d] text-white shadow-lg rounded-t-xl\">\r\n        <div className=\"flex items-center\">\r\n          <h3 className=\"text-xl font-bold tracking-wide flex items-center\">\r\n            Hello, it's <Shell className=\"mx-2 text-[#b0e0e6]\" size={28} />\r\n          </h3>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2 ml-auto\">\r\n          <button\r\n            onClick={handleSummarizeChat}\r\n            className={`p-2 rounded-md transition-colors ${\r\n              isSummarizing\r\n                ? 'bg-[#1a2d2d] text-[#a0a0a0] cursor-not-allowed'\r\n                : 'text-white bg-[#5f9ea0] hover:bg-[#4d8c8e]'\r\n            }`}\r\n            disabled={isSummarizing}\r\n            aria-label=\"Summarize chat\"\r\n          >\r\n            {isSummarizing ? (\r\n              <RandomColorLoader className=\"h-6 w-6\" />\r\n            ) : (\r\n              <Sparkles size={24} />\r\n            )}\r\n          </button>\r\n          {onClose && (\r\n            <button\r\n              onClick={onClose}\r\n              className=\"p-2 rounded-md text-gray-200 hover:text-white hover:bg-[#2c4e4e]\"\r\n              aria-label=\"Close chat\"\r\n            >\r\n              <X size={24} />\r\n            </button>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n      {/* Chat Messages Display Area */}\r\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar\">\r\n        {messages.map((msg, index) => (\r\n          <div\r\n            key={index}\r\n            className={`flex items-start ${msg.type === 'user' ? 'justify-end' : 'justify-start'}`}\r\n          >\r\n            {msg.type === 'bot' && (\r\n              <div className=\"flex-shrink-0 mr-3 mt-1\">\r\n                <Shell className=\"text-[#a0e0e6]\" size={24} />\r\n              </div>\r\n            )}\r\n            <div\r\n              className={`max-w-[70%] p-3 rounded-xl shadow-md sm:max-w-[60%] ${\r\n                msg.type === 'user'\r\n                  ? 'bg-[#3d7c7c] text-white rounded-br-none'\r\n                  : 'bg-[#2c4e4e] text-gray-200 rounded-bl-none'\r\n              }`}\r\n            >\r\n              {msg.image && (\r\n                <img\r\n                  src={msg.image}\r\n                  alt=\"Uploaded preview\"\r\n                  className=\"max-h-24 w-auto rounded-md mb-2 border border-[#4e7d7d]\"\r\n                />\r\n              )}\r\n              <p className=\"whitespace-pre-wrap\">{msg.text}</p>\r\n            </div>\r\n          </div>\r\n        ))}\r\n        {isLoading && (\r\n          <div className=\"flex justify-start items-center\">\r\n            <div className=\"flex-shrink-0 mr-3 mt-1\">\r\n              <Shell className=\"text-[#a0e0e6] animate-pulse\" size={24} />\r\n            </div>\r\n            <div className=\"bg-[#2c4e4e] p-3 rounded-xl shadow-md rounded-bl-none\">\r\n              <div className=\"flex space-x-1\">\r\n                <div className=\"w-2 h-2 bg-[#5f9ea0] rounded-full animate-bounce\" style={{ animationDelay: '0s' }}></div>\r\n                <div className=\"w-2 h-2 bg-[#5f9ea0] rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\r\n                <div className=\"w-2 h-2 bg-[#5f9ea0] rounded-full animate-bounce\" style={{ animationDelay: '0.4s' }}></div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        {error && (\r\n          <div className=\"text-[#e6b0b0] text-center p-2 bg-[#5c2d2d] rounded-lg\">\r\n            {error}\r\n          </div>\r\n        )}\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {/* Input Area */}\r\n      <div className=\"p-4 bg-[#2c4e4e] border-t border-[#4e7d7d] shadow-inner rounded-b-xl\">\r\n        {imagePreviewUrl && (\r\n          <div className=\"relative mb-3 p-2 border border-[#4e7d7d] rounded-lg bg-[#3d7c7c]\">\r\n            <img src={imagePreviewUrl} alt=\"Image Preview\" className=\"max-h-24 w-auto rounded-md mx-auto\" />\r\n            <button\r\n              onClick={handleRemoveImage}\r\n              className=\"absolute top-1 right-1 bg-[#d32f2f] text-white rounded-full p-1 text-xs hover:bg-[#e53935] transition-colors\"\r\n              aria-label=\"Remove image\"\r\n            >\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                className=\"h-4 w-4\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke=\"currentColor\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M6 18L18 6M6 6l12 12\"\r\n                />\r\n              </svg>\r\n            </button>\r\n          </div>\r\n        )}\r\n        <div className=\"flex items-end space-x-3\">\r\n          <label\r\n            htmlFor=\"imageUpload\"\r\n            className=\"flex-shrink-0 p-3 bg-[#3d7c7c] text-[#a0e0e6] rounded-full cursor-pointer hover:bg-[#4e8d8e] transition-colors shadow-sm\"\r\n            title=\"Upload Image\"\r\n          >\r\n            <svg\r\n              xmlns=\"http://www.w3.org/2000/svg\"\r\n              className=\"h-6 w-6\"\r\n              fill=\"none\"\r\n              viewBox=\"0 0 24 24\"\r\n              stroke=\"currentColor\"\r\n            >\r\n              <path\r\n                strokeLinecap=\"round\"\r\n                strokeLinejoin=\"round\"\r\n                strokeWidth={2}\r\n                d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\r\n              />\r\n            </svg>\r\n            <input\r\n              id=\"imageUpload\"\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              className=\"hidden\"\r\n              onChange={handleImageChange}\r\n              disabled={isLoading || isSummarizing}\r\n            />\r\n          </label>\r\n\r\n          <textarea\r\n            ref={textareaRef}\r\n            className=\"flex-1 resize-none overflow-hidden p-3 border border-[#4e7d7d] rounded-xl focus:outline-none focus:ring-2 focus:ring-[#a0e0e6] text-gray-100 bg-[#3d7c7c] transition-all duration-200 text-sm sm:text-base\"\r\n            placeholder=\"Type your message...\"\r\n            rows=\"1\"\r\n            value={inputText}\r\n            onChange={handleInputChange}\r\n            onKeyPress={(e) => {\r\n              if (e.key === 'Enter' && !e.shiftKey) {\r\n                e.preventDefault();\r\n                handleSendMessage();\r\n              }\r\n            }}\r\n            disabled={isLoading || isSummarizing}\r\n          ></textarea>\r\n\r\n          <button\r\n            onClick={handleSendMessage}\r\n            className={`flex-shrink-0 p-3 rounded-full shadow-lg transition-all duration-200 ${\r\n              isLoading || isSummarizing || (!inputText.trim() && !selectedImage)\r\n                ? 'bg-[#3d7c7c] text-[#a0a0a0] cursor-not-allowed'\r\n                : 'bg-[#5f9ea0] text-white hover:bg-[#4d8c8e]'\r\n            }`}\r\n            disabled={isLoading || isSummarizing || (!inputText.trim() && !selectedImage)}\r\n            title=\"Send Message\"\r\n          >\r\n            {isLoading ? (\r\n              <svg\r\n                className=\"animate-spin h-6 w-6 text-white\"\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n              >\r\n                <circle\r\n                  className=\"opacity-25\"\r\n                  cx=\"12\"\r\n                  cy=\"12\"\r\n                  r=\"10\"\r\n                  stroke=\"currentColor\"\r\n                  strokeWidth=\"4\"\r\n                ></circle>\r\n                <path\r\n                  className=\"opacity-75\"\r\n                  fill=\"currentColor\"\r\n                  d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"\r\n                ></path>\r\n              </svg>\r\n            ) : (\r\n              <svg\r\n                xmlns=\"http://www.w3.org/2000/svg\"\r\n                className=\"h-6 w-6 rotate-90\"\r\n                fill=\"none\"\r\n                viewBox=\"0 0 24 24\"\r\n                stroke=\"currentColor\"\r\n              >\r\n                <path\r\n                  strokeLinecap=\"round\"\r\n                  strokeLinejoin=\"round\"\r\n                  strokeWidth={2}\r\n                  d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\"\r\n                />\r\n              </svg>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n      {/* Custom Scrollbar Styling */}\r\n      <style>{`\r\n        .custom-scrollbar::-webkit-scrollbar {\r\n          width: 8px;\r\n        }\r\n        .custom-scrollbar::-webkit-scrollbar-track {\r\n          background: #3d7c7c;\r\n          border-radius: 10px;\r\n        }\r\n        .custom-scrollbar::-webkit-scrollbar-thumb {\r\n          background: #5f9ea0;\r\n          border-radius: 10px;\r\n        }\r\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\r\n          background: #a0e0e6;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatBotApp;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}